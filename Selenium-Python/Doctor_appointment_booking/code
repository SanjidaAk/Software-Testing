import time
import logging
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import Select


service = Service(executable_path='C:\\Windows\\chromedriver.exe')
options = webdriver.ChromeOptions()
options.add_experimental_option("detach", True)

driver = webdriver.Chrome(options=options, service=Service(ChromeDriverManager().install()))

logging.basicConfig(filename='flight.log', format='%(asctime)s: %(levelname)s: %(message)s',
                    datefmt='%y/%m/%d %H:%M:%S', level=logging.INFO, filemode='w')

# Open the browser
driver.get('https://katalon-demo-cura.herokuapp.com/')
driver.maximize_window()
logging.info('ChromeDriver was opened successfully')

element = driver.find_element(By.XPATH, "//a[@id='btn-make-appointment']")
element.click()
time.sleep(2)

Username = driver.find_element(By.ID, "txt-username")
Username.send_keys("John Doe")

Password = driver.find_element(By.ID, "txt-password")
Password.send_keys("ThisIsNotAPassword")
time.sleep(2)

Click_login_button = driver.find_element(By.ID, "btn-login")
Click_login_button.click()

#Home page
sta_drpdwn = Select(driver.find_element(By.XPATH,"//select[@id='combo_facility']"))
sta_drpdwn.select_by_value("Seoul CURA Healthcare Center")
time.sleep(1)

Button = driver.find_element(By.NAME, "hospital_readmission")
Button.click()
time.sleep(1)

Radio_button = driver.find_element(By.XPATH, "//input[@value='Medicaid']")
Radio_button.click()
time.sleep(1)

date_picker = driver.find_element(By.ID, "txt_visit_date")
date_picker.send_keys("05/05/2024")
time.sleep(1)

Comment_text = driver.find_element(By.NAME, "comment")
Comment_text.send_keys("Very Important")
time.sleep(1)

Booking_button = driver.find_element(By.ID, "btn-book-appointment")
Booking_button.click()


